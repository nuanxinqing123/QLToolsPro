import{N as e,k as a,w as t,f as l,a4 as i,a6 as d,c as r,a8 as s,u as n,L as o,a3 as p,q as u,a2 as c,r as _,i as m,F as y,J as v}from"./@vue-11129043.js";import{p as f}from"./p-center-modal-916ba484.js";import"./dayjs-c306acb6.js";import{Y as k,Z as b,_ as g,$ as h,a0 as j,a1 as x,a2 as C}from"./index-9781d2dc.js";import{m as w,F as I,E as U}from"./ant-design-vue-93fc40b2.js";import{s as K,d as D}from"./common-3c8652c5.js";import{_ as S}from"./page-container-94b32927.js";import{S as F,ak as q}from"./@ant-design-477981d5.js";import"./pinia-1ca0c29b.js";import"./vue-demi-a81ff0a7.js";import"./store-325aa5d6.js";import"./_plugin-vue_export-helper-9b9a8a5b.js";import"./@babel-eab0ef53.js";import"./axios-93d3568f.js";import"./qs-8fb0a9f1.js";import"./side-channel-ee547e73.js";import"./get-intrinsic-53528089.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-566c57e8.js";import"./object-inspect-5c6480f3.js";import"./vue-router-36397834.js";import"./vue3-colorpicker-e1559e09.js";import"./vue-types-0fd36d85.js";import"./is-plain-object-39134198.js";import"./tinycolor2-e232e212.js";import"./@vueuse-94329f85.js";import"./@aesoper-316802a3.js";import"./vue3-angle-2884cf46.js";import"./gradient-parser-c9367eab.js";import"./lodash-es-0ceb8576.js";import"./@popperjs-31624eb1.js";import"./resize-observer-polyfill-9cd09a67.js";import"./@ctrl-16df70a4.js";import"./dom-align-6a5270eb.js";import"./async-validator-604317c1.js";import"./scroll-into-view-if-needed-8ce8502d.js";import"./compute-scroll-into-view-cce79123.js";const A=o("取消"),E=o("提交"),O={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(o,{emit:u}){const c=o,{visible:_,dataObj:m}=e(c),y=()=>{u("update:visible",!1)},v=a({state:!1,cd_key_remarks:""}),b={state:[{required:!0,trigger:"change"}],cd_key_remarks:[{required:!0,trigger:"change"}]},g=e=>{},h=(...e)=>{},j={labelCol:{span:7},wrapperCol:{span:15}},x=e=>{const a={...v};let t=null;m.value.ID&&(a.id=m.value.ID,t=k),t({data:a}).then((()=>{w.success("操作成功"),u("updateData",a),y()}))};t(_,((e,a,t)=>{_.value&&C()}));const C=()=>{m.value.ID?(v.state=m.value.CdKeyState,v.cd_key_remarks=m.value.CdKeyRemarks):(v.state=!1,v.cd_key_remarks="")};return(e,a)=>{const t=p("a-switch"),o=p("a-form-item"),u=p("a-input"),c=p("a-divider"),k=p("a-button"),C=p("a-form");return l(),i(f,{modalVisible:n(_),isFooter:!1,onClose:y,title:n(m).title},{content:d((()=>[r(C,s({ref:"formRef",name:"custom-validation",model:v,rules:b},j,{onValidate:h,onFinishFailed:g,onFinish:x}),{default:d((()=>[r(o,{label:"CD-KEY状态",name:"state"},{default:d((()=>[r(t,{checked:v.state,"onUpdate:checked":a[0]||(a[0]=e=>v.state=e),"checked-children":"开启","un-checked-children":"关闭"},null,8,["checked"])])),_:1}),r(o,{label:"CD-KEY标识",name:"cd_key_remarks"},{default:d((()=>[r(u,{value:v.cd_key_remarks,"onUpdate:value":a[1]||(a[1]=e=>v.cd_key_remarks=e)},null,8,["value"])])),_:1}),r(c),r(o,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:d((()=>[r(k,{onClick:y},{default:d((()=>[A])),_:1}),r(k,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:d((()=>[E])),_:1})])),_:1})])),_:1},16,["model"])])),_:1},8,["modalVisible","title"])}}},V=o("积分"),R=o("会员"),T=o("取消"),z=o("提交"),Y={__name:"generateCardSecret",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(o,{emit:_}){const m=o,{visible:y,dataObj:v}=e(m),k=()=>{_("update:visible",!1)},h=a({cd_key_count:1,cd_key_type:"integral",cd_key_integral:void 0,cd_key_validity_period:"",cd_key_prefix:"",cd_key_remarks:""}),j=u((()=>({cd_key_integral:[{required:"integral"==h.cd_key_type,trigger:"change",message:"请输入卡密积分"}],cd_key_validity_period:[{required:"integral"!=h.cd_key_type,trigger:"change",message:"请输入卡密有效期"},{required:!1,pattern:new RegExp(/^[1-9]\d*$/,"g"),message:"请输入正确的卡密有效期"}],cd_key_count:[{required:!0,trigger:"change"}],cd_key_type:[{required:!0,trigger:"change"}]}))),x=()=>{"integral"==h.cd_key_type?(h.cd_key_validity_period=0,h.cd_key_integral=""):(h.cd_key_integral=0,h.cd_key_validity_period="")},C=e=>{},I=(...e)=>{},U={labelCol:{span:7},wrapperCol:{span:15}},D=e=>{const a={...h,cd_key_validity_period:K(h.cd_key_validity_period)};b({data:a}).then((()=>{w.success("操作成功"),g(),_("updateData",a),k()}))};t(y,((e,a,t)=>{y.value&&S()}));const S=()=>{h.cd_key_count=1,h.cd_key_type="integral",h.cd_key_integral=void 0,h.cd_key_validity_period=0,h.cd_key_prefix="",h.cd_key_remarks=""};return(e,a)=>{const t=p("a-input-number"),o=p("a-form-item"),u=p("a-radio"),_=p("a-radio-group"),m=p("a-input"),v=p("a-divider"),b=p("a-button"),g=p("a-form");return l(),i(f,{modalVisible:n(y),isFooter:!1,onClose:k,title:"生成卡密"},{content:d((()=>[r(g,s({ref:"formRef",name:"custom-validation",model:h,rules:n(j)},U,{onValidate:I,onFinishFailed:C,onFinish:D}),{default:d((()=>[r(o,{label:"生成数量",name:"cd_key_count"},{default:d((()=>[r(t,{value:h.cd_key_count,"onUpdate:value":a[0]||(a[0]=e=>h.cd_key_count=e),style:{},min:"0"},null,8,["value"])])),_:1}),r(o,{label:"卡密类型",name:"cd_key_type"},{default:d((()=>[r(_,{value:h.cd_key_type,"onUpdate:value":a[1]||(a[1]=e=>h.cd_key_type=e),onChange:x},{default:d((()=>[r(u,{value:"integral",name:"type"},{default:d((()=>[V])),_:1}),r(u,{value:"vip",name:"type"},{default:d((()=>[R])),_:1})])),_:1},8,["value"])])),_:1}),"integral"==h.cd_key_type?(l(),i(o,{key:0,label:"卡密积分",name:"cd_key_integral"},{default:d((()=>[r(t,{value:h.cd_key_integral,"onUpdate:value":a[2]||(a[2]=e=>h.cd_key_integral=e),placeholder:"请输入卡密积分",style:{},min:"0"},null,8,["value"])])),_:1})):c("",!0),"vip"==h.cd_key_type?(l(),i(o,{key:1,name:"cd_key_validity_period",label:"卡密有效期"},{default:d((()=>[r(m,{value:h.cd_key_validity_period,"onUpdate:value":a[3]||(a[3]=e=>h.cd_key_validity_period=e),placeholder:"请输入CD-KEY有效期",suffix:"天",style:{}},null,8,["value"])])),_:1})):c("",!0),r(o,{label:"卡密前缀",name:"cd_key_prefix"},{default:d((()=>[r(m,{value:h.cd_key_prefix,"onUpdate:value":a[4]||(a[4]=e=>h.cd_key_prefix=e)},null,8,["value"])])),_:1}),r(o,{label:"卡密标识",name:"cd_key_remarks"},{default:d((()=>[r(m,{value:h.cd_key_remarks,"onUpdate:value":a[5]||(a[5]=e=>h.cd_key_remarks=e)},null,8,["value"])])),_:1}),r(v),r(o,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:d((()=>[r(b,{onClick:k},{default:d((()=>[T])),_:1}),r(b,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:d((()=>[z])),_:1})])),_:1})])),_:1},16,["model","rules"])])),_:1},8,["modalVisible"])}}},L=o("生成卡密 "),P=o(" 搜索 "),B=o("重置 "),M=o("启用"),N=o("禁用"),$=o("修改 "),G=o(" 是否确认删除？ "),J=o("删除 "),Z={__name:"index",setup(e){const t=_({}),s=_(!1),o=_(!1),f=_({}),k=I.useForm,b=_(0),g=_(1),K=_(10);U.PRESENTED_IMAGE_SIMPLE;const A=a({s:"",ctype:""});_(!1);const{resetFields:E,validate:V,validateInfos:R}=k(A),T=u((()=>({s:[{required:!1,trigger:"change",message:"请输入关键字"}]}))),z=_([{value:"",label:"全部"},{value:"integral",label:"积分"},{value:"vip",label:"会员"}]),Z=[{title:"ID",dataIndex:"ID",fixed:"left",width:120},{title:"卡密显示",dataIndex:"CdKey",width:200},{title:"类型",dataIndex:"CdKeyTypeStr",width:200},{title:"积分",dataIndex:"CdKeyIntegral",width:200},{title:"有效期",dataIndex:"CdKeyValidityPeriod",width:200},{title:"标识",dataIndex:"CdKeyRemarks",width:200},{title:"状态",dataIndex:"CdKeyState",customKey:"state",width:200},{title:"创建时间",dataIndex:"CreatedAt",width:280},{title:"更新时间",dataIndex:"UpdatedAt",width:280},{title:"操作",dataIndex:"operation",customKey:"operation",fixed:"right",width:300}],H=_([]),Q=e=>{e&&(g.value=1);let a=null,t={page:g.value},l=!1;f.value.ctype?f.value.s?(a=j,t={s:f.value.s||"",ctype:f.value.ctype}):(l=!0,a=x,t={ctype:f.value.ctype,page:g.value,quantity:K.value}):(a=C,t={s:f.value.s||""}),a({data:A,splicingData:t}).then((e=>{b.value=l?e.page*K.value:0,H.value=(e.pageData||e||[]).map((e=>(e.CdKeyType&&(e.CdKeyTypeStr="vip"==e.CdKeyType?"会员":"积分"),e.CreatedAt&&(e.CreatedAt=D(e.CreatedAt)),e.UpdatedAt&&(e.UpdatedAt=D(e.UpdatedAt)),e)))}))},W=()=>{E(),f.value=A,Q(!0)},X=()=>{V().then((e=>{f.value=A,Q(!0)})).catch((e=>{}))};return(e,a)=>{const u=p("a-select"),_=p("a-form-item"),f=p("a-input"),k=p("a-button"),j=p("a-form"),x=p("count-animation"),C=p("a-popconfirm");return l(),m(y,null,[r(Y,{visible:s.value,"onUpdate:visible":a[0]||(a[0]=e=>s.value=e),onUpdateData:a[1]||(a[1]=e=>Q(!0))},null,8,["visible"]),r(O,{visible:o.value,"onUpdate:visible":a[2]||(a[2]=e=>o.value=e),onUpdateData:a[3]||(a[3]=e=>Q(!0)),dataObj:t.value},null,8,["visible","dataObj"]),r(S,{columns:Z,pageSize:K.value,"onUpdate:pageSize":a[7]||(a[7]=e=>K.value=e),current:g.value,"onUpdate:current":a[8]||(a[8]=e=>g.value=e),total:b.value,"onUpdate:total":a[9]||(a[9]=e=>b.value=e),isTable:!0,isSearch:!0,onOnShowSizeChange:Q,onInitData:Q,dataSource:H.value},{search:d((()=>[r(j,{class:"flex flex-warp",rules:n(T),onFinish:X,model:A},{default:d((()=>[r(_,{label:"类型:",name:"ctype"},{default:d((()=>[r(u,{value:A.ctype,"onUpdate:value":a[4]||(a[4]=e=>A.ctype=e),placeholder:"请选择",style:{width:"200px"},options:z.value},null,8,["value","options"])])),_:1}),r(_,{label:"关键字:",name:"s"},{default:d((()=>[r(f,{value:A.s,"onUpdate:value":a[5]||(a[5]=e=>A.s=e),placeholder:"请输入关键字"},null,8,["value"])])),_:1}),r(_,null,{default:d((()=>[r(k,{type:"primary",onClick:a[6]||(a[6]=v((e=>s.value=!0),["stop"])),shape:"round"},{default:d((()=>[L])),_:1}),r(k,{type:"primary","html-type":"submit",style:{"margin-left":"10px"},class:"filter-search"},{default:d((()=>[r(n(F)),P])),_:1}),r(k,{style:{"margin-left":"10px"},class:"filter-reset",onClick:W},{default:d((()=>[r(n(q)),B])),_:1})])),_:1})])),_:1},8,["rules","model"])])),bodyCell:d((({text:e,record:a,index:s,column:n})=>["state"===n.customKey?(l(),m(y,{key:0},[a.CdKeyState?(l(),i(k,{key:0,type:"link",primary:"",class:"state-button state-enable"},{default:d((()=>[M])),_:1})):(l(),i(k,{key:1,type:"link",danger:"",class:"state-button"},{default:d((()=>[N])),_:1}))],64)):c("",!0),"money"===n.customKey?(l(),i(x,{key:1,num:e},null,8,["num"])):c("",!0),"operation"===n.customKey?(l(),m(y,{key:2},[r(k,{type:"primary",onClick:v((e=>{return l=a,o.value=!0,void(t.value=l?{...l,title:"卡密编辑"}:{title:"卡密新增"});var l}),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:d((()=>[$])),_:2},1032,["onClick"]),r(C,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:e=>{h({data:{id_list:[a.ID]}}).then((()=>{w.success("操作成功!"),Q(!0)}))}},{title:d((()=>[G])),default:d((()=>[r(k,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:d((()=>[J])),_:1})])),_:2},1032,["onConfirm"])],64)):c("",!0)])),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{Z as default};
